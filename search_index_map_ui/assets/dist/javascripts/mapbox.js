!function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=5)}({5:function(e,t){mapboxgl.accessToken="pk.eyJ1IjoibWF0dGdpcmRsZXIiLCJhIjoiY2lteW85cm5lMDBmcnY5bTFxY2Zsc3c2OCJ9.VvO2DhAhOVrcjJ0Usw8JIA";var r=new mapboxgl.Map({style:"mapbox://styles/mattgirdler/cjznu3ztu06m31clp2j37yybz",center:[-3.5208657,50.7227184],zoom:17.5,pitch:45,bearing:-17.6,container:"map",antialias:!0}),n="exeter_buildings_with_height-0ygi87",i=[{layer:"airspace-leasehold-a6g827",sourceLayer:"airspace-a6g827"},{layer:"freehold-diumk5",sourceLayer:"osgb1000012317615-freehold-diumk5"},{layer:"leasehold-0-83okhj",sourceLayer:"osgb1000012317615-0-83okhj"},{layer:"leasehold-1-54g9gf",sourceLayer:"osgb1000012317615-1-54g9gf"},{layer:"leasehold-2-ccs62k",sourceLayer:"osgb1000012317615-2-ccs62k"},{layer:"leasehold-3-8aah9q",sourceLayer:"osgb1000012317615-3-8aah9q"}],a=document.getElementById("spatial-units"),o=JSON.parse(a.innerHTML)[0];function s(e){for(var t in i){if(i[t].layer.includes(e))"visible"==r.getLayoutProperty(i[t].layer,"visibility")?(r.setLayoutProperty(i[t].layer,"visibility","none"),this.className=""):(this.className="active",r.setLayoutProperty(i[t].layer,"visibility","visible"))}}r.on("load",function(){var e=[];for(var t in i)if(!i[t].layer.includes("airspace")){var a=r.querySourceFeatures("composite",{sourceLayer:i[t].sourceLayer});for(var s in a)e.includes(a[s].properties.fid)||e.push(a[s].properties.fid)}var p=["in","fid"].concat(e),d=r.querySourceFeatures("composite",{sourceLayer:n,filter:p});for(var l in d)r.setFeatureState({id:d[l].id,source:"composite",sourceLayer:n},{hide:!0}),u(d[l].properties.fid);var c=document.getElementById("title-information-overlay");function u(e){for(var t in i)if(r.setLayoutProperty(i[t].layer,"visibility","visible"),!i[t].layer.includes("airspace")){var a=r.querySourceFeatures("composite",{sourceLayer:i[t].sourceLayer});for(var o in a){var s=0,p=0;if(i[t].layer.includes("freehold"))p=120;else{var d=a[o].properties.fid,l=r.querySourceFeatures("composite",{sourceLayer:n,filter:["==","fid",d]})[0].properties.RelHmax/a[o].properties.num_floors;p=l*(a[o].properties.floor+1),s=l*a[o].properties.floor}r.setPaintProperty(i[t].layer,"fill-extrusion-height",p,{validate:!0}),r.setPaintProperty(i[t].layer,"fill-extrusion-base",s,{validate:!0})}}}function m(e){var t=function(e){var t=[];for(var r in o)o[r].ba_units[0].name==e&&t.push(o[r].id);return t}(y(e).ba_units[0].name);for(var n in i)for(var a in t){var s=r.querySourceFeatures("composite",{sourceLayer:i[n].sourceLayer,filter:["==","id",t[a]]});for(var p in s)r.setFeatureState({id:s[p].id,source:"composite",sourceLayer:i[n].sourceLayer},{highlight:!0})}}function y(e){return o.find(function(t){return t.id==e})}document.getElementById("toggle-layers-overlay").style.display="block",r.on("mousemove",function(e){!function(){for(var e in i)c.style.display="none",r.removeFeatureState({source:"composite",sourceLayer:i[e].sourceLayer})}();var t=[];for(var n in i)t.push(i[n].layer);var a=r.queryRenderedFeatures(e.point,{layers:t});if(a.length>0){var o=a[0];m(o.properties.id);var s=y(o.properties.id),p=[];if(s)for(var d in s.ba_units){var l=s.ba_units[d],u={address:s.address,titleNumber:l.name,pricePaid:[],rights:[],restrictions:[],responsibilities:[]};for(var v in s.price_paid){var h=s.price_paid[v];u.pricePaid.push({amount:h.amount,date:h.date})}for(var f in l.rights){var g=l.rights[f],C={rightId:g.right_id,type:g.type,description:g.description,mortgages:[]};for(var b in g.party&&(C.party={name:g.party.name,type:g.party.type,partyId:g.party}),g.mortgages){var E=g.mortgages[b],x={type:E.type,amount:E.amount,interestRate:E.interest_rate};C.mortgages.push(x)}u.rights.push(C)}for(var L in l.restrictions){var P=l.restrictions[L],_={type:P.type,description:P.description};P.party&&(_.party={name:P.party.name,type:P.party.type,partyId:P.party}),u.restrictions.push(_)}for(var j in l.responsibilities){var S=l.responsibilities[j],F={type:S.type,description:S.description};S.party&&(F.party={name:S.party.name,type:S.party.type,partyId:S.party}),u.responsibilities.push(F)}p.push(u)}c.innerHTML="";var I=document.createElement("h1");I.textContent=p[0].rights[0].type,c.appendChild(I);var O=document.createElement("strong");O.textContent="Title number: ",c.append(O);var k=document.createElement("span");if(k.append(p[0].titleNumber),c.appendChild(k),p[0].address){var T=document.createElement("div"),q=document.createElement("strong");q.textContent="Address: ",T.append(q);var M=document.createElement("span");M.textContent=p[0].address,T.append(M),c.appendChild(T)}c.appendChild(document.createElement("hr"));var R=document.createElement("div");if(p[0].pricePaid.length>0){var D=document.createElement("strong");for(var J in D.textContent="Prices Paid:",R.appendChild(D),p[0].pricePaid){var N=document.createElement("div");N.style="margin-left: 10px;";var B=document.createElement("span");B.textContent=p[0].pricePaid[J].date+" - "+p[0].pricePaid[J].amount,N.appendChild(B),N.appendChild(document.createElement("br")),R.appendChild(N)}c.appendChild(R),c.appendChild(document.createElement("hr"))}var w=document.createElement("div");if(p[0].rights.length>0){var z=document.createElement("strong");for(var A in z.textContent="Rights:",w.appendChild(z),p[0].rights){var H=document.createElement("div");H.style="margin-left: 10px;";var Y=document.createElement("strong");Y.textContent="Type: ",H.appendChild(Y);var V=document.createElement("span");if(V.textContent=p[0].rights[A].type,H.appendChild(V),H.appendChild(document.createElement("br")),p[0].rights[A].description){var W=document.createElement("strong");W.textContent="Description: ",H.appendChild(W);var Z=document.createElement("span");Z.textContent=p[0].rights[A].description,H.appendChild(Z),H.appendChild(document.createElement("br"))}var G=document.createElement("strong");G.textContent="Party: ",H.appendChild(G);var U=document.createElement("span");U.textContent=p[0].rights[A].party.name+" ("+p[0].rights[A].party.type+")",H.appendChild(U),H.appendChild(document.createElement("hr")),w.appendChild(H)}c.appendChild(w)}var X=document.createElement("div");if(p[0].restrictions.length>0){var K=document.createElement("strong");for(restriction in K.textContent="Restrictions:",X.appendChild(K),p[0].restrictions){var Q=document.createElement("div");Q.style="margin-left: 10px;";var $=document.createElement("strong");$.textContent="Type: ",Q.appendChild($);var ee=document.createElement("span");if(ee.textContent=p[0].restrictions[restriction].type,Q.appendChild(ee),Q.appendChild(document.createElement("br")),p[0].restrictions[restriction].description){var te=document.createElement("strong");te.textContent="Description: ",Q.appendChild(te);var re=document.createElement("span");re.textContent=p[0].restrictions[restriction].description,Q.appendChild(re),Q.appendChild(document.createElement("br"))}var ne=document.createElement("strong");ne.textContent="Party: ",Q.appendChild(ne);var ie=document.createElement("span");ie.textContent=p[0].restrictions[restriction].party.name+" ("+p[0].restrictions[restriction].party.type+")",Q.appendChild(ie),Q.appendChild(document.createElement("hr")),X.appendChild(Q)}c.appendChild(X)}var ae=document.createElement("div");if(p[0].responsibilities.length>0){var oe=document.createElement("strong");for(responsibility in oe.textContent="Responsibilities:",ae.appendChild(oe),p[0].responsibilities){var se=document.createElement("div");se.style="margin-left: 10px;";var pe=document.createElement("strong");pe.textContent="Type: ",se.appendChild(pe);var de=document.createElement("span");if(de.textContent=p[0].responsibilities[responsibility].type,se.appendChild(de),se.appendChild(document.createElement("br")),p[0].responsibilities[responsibility].description){var le=document.createElement("strong");le.textContent="Description: ",se.appendChild(le);var ce=document.createElement("span");ce.textContent=p[0].responsibilities[responsibility].description,se.appendChild(ce),se.appendChild(document.createElement("br"))}var ue=document.createElement("strong");ue.textContent="Party: ",se.appendChild(ue);var me=document.createElement("span");me.textContent=p[0].responsibilities[responsibility].party.name+" ("+p[0].responsibilities[responsibility].party.type+")",se.appendChild(me),se.appendChild(document.createElement("hr")),ae.appendChild(se)}c.appendChild(ae)}c.style.display="block"}})});for(var p=document.getElementsByName("filter"),d=0;d<p.length;d++)p[d].addEventListener("change",function(e){var t=e.target.value;e.preventDefault(),e.stopPropagation(),s(t)})}});
//# sourceMappingURL=mapbox.js.map